version: '3.2'

services:
  nginx: 
    image: nginx:1.15-alpine
    container_name: auth-handler
    volumes:
      - ./nginx-ldap-auth.conf:/etc/nginx/nginx.conf
      - ./:/etc/nginx/logs

    ports:
      - "8081:8081"

  daemon:
    build: daemon
    container_name: ldap-handler
    environment:       
      - URL=${URL:?URL is required}
      - BASE=${BASE:?BASE is required}
      - BIND_DN=${BIND_DN:?BIND_DN is required}
      - BIND_PASS=${BIND_PASS:?BIND_PASS is required}
      - COOKIE=${COOKIE:?COOKIE is required}
      - FILTER=${FILTER:?FILTER is required}
      - REALM=${REALM:?REALM is required}
      - CRYPTO_RANDOM_16=${RANDOM16:?RANDOM16 is required}

    ports:
      - "8888:8888"

  sample:
    build: sample
    container_name: sample-app
    environment:       
      - CRYPTO_RANDOM_16=${RANDOM16:?RANDOM16 is required}
    ports:
      - "9000:9000"


 
